Build started...
Build succeeded.
The Entity Framework tools version '6.0.1' is older than that of the runtime '6.0.10'. Update the tools for the latest features and bug fixes. See https://aka.ms/AAc1fbw for more information.
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
GO

BEGIN TRANSACTION;
GO

CREATE TABLE [Brands] (
    [Id] uniqueidentifier NOT NULL,
    [Name] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Brands] PRIMARY KEY ([Id])
);
GO

CREATE TABLE [RentStatuses] (
    [Id] uniqueidentifier NOT NULL,
    [Name] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_RentStatuses] PRIMARY KEY ([Id])
);
GO

CREATE TABLE [Roles] (
    [Id] uniqueidentifier NOT NULL,
    [Name] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Roles] PRIMARY KEY ([Id])
);
GO

CREATE TABLE [VehicleStatuses] (
    [Id] uniqueidentifier NOT NULL,
    [Name] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_VehicleStatuses] PRIMARY KEY ([Id])
);
GO

CREATE TABLE [Departments] (
    [Id] uniqueidentifier NOT NULL,
    [Name] nvarchar(max) NOT NULL,
    [Localisation] nvarchar(max) NOT NULL,
    [ManagerId] uniqueidentifier NULL,
    CONSTRAINT [PK_Departments] PRIMARY KEY ([Id])
);
GO

CREATE TABLE [Users] (
    [Id] uniqueidentifier NOT NULL,
    [FirstName] nvarchar(max) NOT NULL,
    [LastName] nvarchar(max) NOT NULL,
    [Pesel] int NOT NULL,
    [Address] nvarchar(max) NOT NULL,
    [PhoneNumber] int NOT NULL,
    [Email] nvarchar(max) NOT NULL,
    [DepartmentId] uniqueidentifier NOT NULL,
    [RoleId] uniqueidentifier NOT NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Users_Departments_DepartmentId] FOREIGN KEY ([DepartmentId]) REFERENCES [Departments] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Users_Roles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [Roles] ([Id]) ON DELETE CASCADE
);
GO

CREATE TABLE [Vehicles] (
    [Id] uniqueidentifier NOT NULL,
    [Model] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [ImageUrl] nvarchar(max) NOT NULL,
    [PricePerDay] float NOT NULL,
    [YearOfProduction] int NOT NULL,
    [VehicleStatusId] uniqueidentifier NOT NULL,
    [BrandId] uniqueidentifier NOT NULL,
    [DepartmentId] uniqueidentifier NOT NULL,
    CONSTRAINT [PK_Vehicles] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Vehicles_Brands_BrandId] FOREIGN KEY ([BrandId]) REFERENCES [Brands] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Vehicles_Departments_DepartmentId] FOREIGN KEY ([DepartmentId]) REFERENCES [Departments] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Vehicles_VehicleStatuses_VehicleStatusId] FOREIGN KEY ([VehicleStatusId]) REFERENCES [VehicleStatuses] ([Id]) ON DELETE CASCADE
);
GO

CREATE TABLE [Rents] (
    [Id] uniqueidentifier NOT NULL,
    [StartDate] datetime2 NOT NULL,
    [EndDate] datetime2 NOT NULL,
    [RentStatusId] uniqueidentifier NOT NULL,
    [UserId] uniqueidentifier NULL,
    [VehicleId] uniqueidentifier NULL,
    CONSTRAINT [PK_Rents] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Rents_RentStatuses_RentStatusId] FOREIGN KEY ([RentStatusId]) REFERENCES [RentStatuses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Rents_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]),
    CONSTRAINT [FK_Rents_Vehicles_VehicleId] FOREIGN KEY ([VehicleId]) REFERENCES [Vehicles] ([Id])
);
GO

CREATE INDEX [IX_Departments_ManagerId] ON [Departments] ([ManagerId]);
GO

CREATE INDEX [IX_Rents_RentStatusId] ON [Rents] ([RentStatusId]);
GO

CREATE INDEX [IX_Rents_UserId] ON [Rents] ([UserId]);
GO

CREATE INDEX [IX_Rents_VehicleId] ON [Rents] ([VehicleId]);
GO

CREATE INDEX [IX_Users_DepartmentId] ON [Users] ([DepartmentId]);
GO

CREATE INDEX [IX_Users_RoleId] ON [Users] ([RoleId]);
GO

CREATE INDEX [IX_Vehicles_BrandId] ON [Vehicles] ([BrandId]);
GO

CREATE INDEX [IX_Vehicles_DepartmentId] ON [Vehicles] ([DepartmentId]);
GO

CREATE INDEX [IX_Vehicles_VehicleStatusId] ON [Vehicles] ([VehicleStatusId]);
GO

ALTER TABLE [Departments] ADD CONSTRAINT [FK_Departments_Users_ManagerId] FOREIGN KEY ([ManagerId]) REFERENCES [Users] ([Id]);
GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20221022124912_Initial', N'6.0.10');
GO

COMMIT;
GO


